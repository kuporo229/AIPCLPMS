{% extends "base.html" %}

{% block title %}Teacher Dashboard{% endblock %}


{% block content %}
<div class="max-w-5xl mx-auto px-4 sm:px-6 lg:px-8">
    <div class="flex justify-between items-center mb-8">
        <div>
            <h1 class="text-3xl font-bold leading-tight text-gray-900">
                Teacher Dashboard
            </h1>
            <p class="mt-1 text-lg text-gray-600">Welcome back, <span class="font-semibold">{{ session.username }}</span>. What would you like to do?</p>
        </div>
        <a href="{{ url_for('teacher.teacher_profile') }}" class="flex items-center space-x-2 px-4 py-2 bg-white border border-gray-300 rounded-lg shadow-sm text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">
            <svg class="h-5 w-5 text-gray-500" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
              <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-6-3a2 2 0 11-4 0 2 2 0 014 0zM12 12a2 2 0 100-4h-1a1 1 0 100 2h1a2 2 0 000 4h-3a1 1 0 100 2h3a2 2 0 100-4h-1z" clip-rule="evenodd" />
            </svg>
            <span>My Profile</span>
        </a>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <a href="{{ url_for('teacher.teacher_my_clps') }}" class="group bg-white p-6 rounded-xl shadow-md hover:shadow-lg hover:border-indigo-500 border-2 border-transparent transition-all duration-300 flex items-start space-x-4">
            <div class="flex-shrink-0 h-12 w-12 flex items-center justify-center bg-indigo-100 rounded-lg">
                <svg class="h-6 w-6 text-indigo-600" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M12 6.042A8.967 8.967 0 006 3.75c-1.052 0-2.062.18-3 .512v14.25A8.987 8.987 0 016 18c2.305 0 4.408.867 6 2.292m0-14.25a8.966 8.966 0 016-2.292c1.052 0 2.062.18 3 .512v14.25A8.987 8.987 0 0018 18a8.967 8.967 0 00-6 2.292m0-14.25v14.25" />
                </svg>
            </div>
            <div>
                <h3 class="text-lg font-semibold text-gray-900 group-hover:text-indigo-600">My Course Learning Plans</h3>
                <p class="mt-1 text-gray-600">View and manage your personal course learning plans.</p>
            </div>
        </a>

        <a href="{{ url_for('teacher.teacher_all_clps') }}" class="group bg-white p-6 rounded-xl shadow-md hover:shadow-lg hover:border-purple-500 border-2 border-transparent transition-all duration-300 flex items-start space-x-4">
            <div class="flex-shrink-0 h-12 w-12 flex items-center justify-center bg-purple-100 rounded-lg">
                <svg class="h-6 w-6 text-purple-600" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M12 6.042A8.967 8.967 0 006 3.75c-1.052 0-2.062.18-3 .512v14.25A8.987 8.987 0 016 18c2.305 0 4.408.867 6 2.292m0-14.25a8.966 8.966 0 016-2.292c1.052 0 2.062.18 3 .512v14.25A8.987 8.987 0 0018 18a8.967 8.967 0 00-6 2.292m0-14.25v14.25" />
                </svg>
            </div>
            <div>
                <h3 class="text-lg font-semibold text-gray-900 group-hover:text-purple-600">All Course Learning Plans</h3>
                <p class="mt-1 text-gray-600">Browse all uploaded and AI-generated learning plans across departments.</p>
            </div>
        </a>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
    function updateNotificationCount() {
        fetch('{{ url_for('main.check_notifications') }}')
            .then(response => response.json())
            .then(data => {
                const badge = document.getElementById('notification-badge');
                if (badge) { // Check if badge exists
                    if (data.unread_count > 0) {
                        badge.textContent = data.unread_count;
                        badge.classList.remove('hidden');
                    } else {
                        badge.classList.add('hidden');
                    }
                }
            })
            .catch(error => console.error('Error fetching notifications:', error));
    }

    // Call immediately on page load
    updateNotificationCount();
    // Set an interval to check every 30 seconds (adjust as needed)
    setInterval(updateNotificationCount, 30000); // 30 seconds
</script>
{% endblock %}